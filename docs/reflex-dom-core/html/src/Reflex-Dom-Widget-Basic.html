<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>src/Reflex/Dom/Widget/Basic.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE ConstraintKinds #-}</span>
<a name="line-2"></a><span class='hs-comment'>{-# LANGUAGE DataKinds #-}</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE FlexibleContexts #-}</span>
<a name="line-4"></a><span class='hs-comment'>{-# LANGUAGE FlexibleInstances #-}</span>
<a name="line-5"></a><span class='hs-comment'>{-# LANGUAGE GADTs #-}</span>
<a name="line-6"></a><span class='hs-comment'>{-# LANGUAGE MultiParamTypeClasses #-}</span>
<a name="line-7"></a><span class='hs-comment'>{-# LANGUAGE OverloadedStrings #-}</span>
<a name="line-8"></a><span class='hs-comment'>{-# LANGUAGE RankNTypes #-}</span>
<a name="line-9"></a><span class='hs-comment'>{-# LANGUAGE RecursiveDo #-}</span>
<a name="line-10"></a><span class='hs-comment'>{-# LANGUAGE ScopedTypeVariables #-}</span>
<a name="line-11"></a><span class='hs-comment'>{-# LANGUAGE TypeFamilies #-}</span>
<a name="line-12"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Dom</span><span class='hs-varop'>.</span><span class='hs-conid'>Widget</span><span class='hs-varop'>.</span><span class='hs-conid'>Basic</span>
<a name="line-13"></a>  <span class='hs-layout'>(</span> <span class='hs-varid'>partitionMapBySetLT</span>
<a name="line-14"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>ChildResult</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-15"></a>
<a name="line-16"></a>  <span class='hs-comment'>-- * Displaying Values</span>
<a name="line-17"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>text</span>
<a name="line-18"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>dynText</span>
<a name="line-19"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>display</span>
<a name="line-20"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>button</span>
<a name="line-21"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>dyn</span>
<a name="line-22"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>dyn_</span>
<a name="line-23"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>widgetHold</span>
<a name="line-24"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>widgetHold_</span>
<a name="line-25"></a>
<a name="line-26"></a>  <span class='hs-comment'>-- * Creating DOM Elements</span>
<a name="line-27"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>el</span>
<a name="line-28"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elAttr</span>
<a name="line-29"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elClass</span>
<a name="line-30"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elDynAttr</span>
<a name="line-31"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elDynClass</span>
<a name="line-32"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elDynAttrNS</span>
<a name="line-33"></a>
<a name="line-34"></a>  <span class='hs-comment'>-- ** With Element Results</span>
<a name="line-35"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>el'</span>
<a name="line-36"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elAttr'</span>
<a name="line-37"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elClass'</span>
<a name="line-38"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elDynAttr'</span>
<a name="line-39"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elDynClass'</span>
<a name="line-40"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>elDynAttrNS'</span>
<a name="line-41"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>dynamicAttributesToModifyAttributes</span>
<a name="line-42"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>dynamicAttributesToModifyAttributesWithInitial</span>
<a name="line-43"></a>
<a name="line-44"></a>  <span class='hs-comment'>-- * Specific DOM Elements</span>
<a name="line-45"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>Link</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-46"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>linkClass</span>
<a name="line-47"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>link</span>
<a name="line-48"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>divClass</span>
<a name="line-49"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>dtdd</span>
<a name="line-50"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>blank</span>
<a name="line-51"></a>
<a name="line-52"></a>  <span class='hs-comment'>-- * Tables and Lists</span>
<a name="line-53"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>tableDynAttr</span>
<a name="line-54"></a>  <span class='hs-layout'>,</span> <span class='hs-varid'>tabDisplay</span>
<a name="line-55"></a>
<a name="line-56"></a>  <span class='hs-layout'>,</span> <span class='hs-conid'>HasAttributes</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span>
<a name="line-57"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-conid'>Misc</span>
<a name="line-58"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Collection</span>
<a name="line-59"></a>  <span class='hs-layout'>,</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Workflow</span>
<a name="line-60"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-61"></a>
<a name="line-62"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Class</span>
<a name="line-63"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Collection</span>
<a name="line-64"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Dom</span><span class='hs-varop'>.</span><span class='hs-conid'>Builder</span><span class='hs-varop'>.</span><span class='hs-conid'>Class</span>
<a name="line-65"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Dom</span><span class='hs-varop'>.</span><span class='hs-conid'>Class</span>
<a name="line-66"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Dynamic</span>
<a name="line-67"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Network</span>
<a name="line-68"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>NotReady</span><span class='hs-varop'>.</span><span class='hs-conid'>Class</span>
<a name="line-69"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>PostBuild</span><span class='hs-varop'>.</span><span class='hs-conid'>Class</span>
<a name="line-70"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Reflex</span><span class='hs-varop'>.</span><span class='hs-conid'>Workflow</span>
<a name="line-71"></a>
<a name="line-72"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Arrow</span>
<a name="line-73"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Lens</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>children</span><span class='hs-layout'>,</span> <span class='hs-varid'>element</span><span class='hs-layout'>)</span>
<a name="line-74"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span><span class='hs-varop'>.</span><span class='hs-conid'>Reader</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>forM</span><span class='hs-layout'>,</span> <span class='hs-varid'>forM_</span><span class='hs-layout'>,</span> <span class='hs-varid'>mapM</span><span class='hs-layout'>,</span> <span class='hs-varid'>mapM_</span><span class='hs-layout'>,</span> <span class='hs-varid'>sequence</span><span class='hs-layout'>,</span> <span class='hs-varid'>sequence_</span><span class='hs-layout'>)</span>
<a name="line-75"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Align</span>
<a name="line-76"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Default</span>
<a name="line-77"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Either</span>
<a name="line-78"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Foldable</span>
<a name="line-79"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Functor</span> <span class='hs-layout'>(</span><span class='hs-varid'>void</span><span class='hs-layout'>)</span>
<a name="line-80"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span><span class='hs-layout'>)</span>
<a name="line-81"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Map</span>
<a name="line-82"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-conid'>Misc</span>
<a name="line-83"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Maybe</span>
<a name="line-84"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-layout'>)</span>
<a name="line-85"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Set</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Set</span>
<a name="line-86"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span> <span class='hs-layout'>(</span><span class='hs-conid'>Text</span><span class='hs-layout'>)</span>
<a name="line-87"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Text</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>T</span>
<a name="line-88"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>These</span>
<a name="line-89"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Traversable</span>
<a name="line-90"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>mapM</span><span class='hs-layout'>,</span> <span class='hs-varid'>mapM_</span><span class='hs-layout'>,</span> <span class='hs-varid'>sequence</span><span class='hs-layout'>,</span> <span class='hs-varid'>sequence_</span><span class='hs-layout'>)</span>
<a name="line-91"></a>
<a name="line-92"></a><span class='hs-comment'>-- | Breaks the given Map into pieces based on the given Set.  Each piece will contain only keys that are less than the key of the piece, and greater than or equal to the key of the piece with the next-smaller key.  There will be one additional piece containing all keys from the original Map that are larger or equal to the largest key in the Set.</span>
<a name="line-93"></a><span class='hs-comment'>-- Either k () is used instead of Maybe k so that the resulting map of pieces is sorted so that the additional piece has the largest key.</span>
<a name="line-94"></a><span class='hs-comment'>-- No empty pieces will be included in the output.</span>
<a name="line-95"></a>
<a name="line-96"></a><a name="partitionMapBySetLT"></a><span class='hs-comment'>--TODO: This can probably be done more efficiently by dividing and conquering, re-using the structure of the Set instead of going through the Set linearally</span>
<a name="line-97"></a><span class='hs-definition'>partitionMapBySetLT</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span><span class='hs-varop'>.</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-varid'>k</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<a name="line-98"></a><span class='hs-definition'>partitionMapBySetLT</span> <span class='hs-varid'>s</span> <span class='hs-varid'>m0</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>fromDistinctAscList</span> <span class='hs-varop'>$</span> <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set</span><span class='hs-varop'>.</span><span class='hs-varid'>toAscList</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span> <span class='hs-varid'>m0</span>
<a name="line-99"></a>  <span class='hs-keyword'>where</span> <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>k</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Either</span> <span class='hs-varid'>k</span> <span class='hs-conid'>()</span><span class='hs-layout'>,</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-100"></a>        <span class='hs-varid'>go</span> <span class='hs-conid'>[]</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>if</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>null</span> <span class='hs-varid'>m</span>
<a name="line-101"></a>                  <span class='hs-keyword'>then</span> <span class='hs-conid'>[]</span>
<a name="line-102"></a>                  <span class='hs-keyword'>else</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Right</span> <span class='hs-conid'>()</span><span class='hs-layout'>,</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<a name="line-103"></a>        <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-varid'>h</span><span class='hs-conop'>:</span><span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <span class='hs-layout'>(</span><span class='hs-varid'>lt</span><span class='hs-layout'>,</span> <span class='hs-varid'>eq</span><span class='hs-layout'>,</span> <span class='hs-varid'>gt</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>splitLookup</span> <span class='hs-varid'>h</span> <span class='hs-varid'>m</span>
<a name="line-104"></a>                         <span class='hs-varid'>geq</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>maybe</span> <span class='hs-varid'>id</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>insert</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>eq</span> <span class='hs-varid'>gt</span>
<a name="line-105"></a>                     <span class='hs-keyword'>in</span> <span class='hs-keyword'>if</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>null</span> <span class='hs-varid'>lt</span>
<a name="line-106"></a>                        <span class='hs-keyword'>then</span> <span class='hs-varid'>go</span> <span class='hs-varid'>t</span> <span class='hs-varid'>geq</span>
<a name="line-107"></a>                        <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><span class='hs-conid'>Left</span> <span class='hs-varid'>h</span><span class='hs-layout'>,</span> <span class='hs-varid'>lt</span><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <span class='hs-varid'>go</span> <span class='hs-varid'>t</span> <span class='hs-varid'>geq</span>
<a name="line-108"></a>
<a name="line-109"></a><a name="ChildResult"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>ChildResult</span> <span class='hs-varid'>t</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ChildResult</span> <span class='hs-layout'>{</span> <span class='hs-varid'>unChildResult</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>ChildResult</span> <span class='hs-varid'>t</span> <span class='hs-varid'>k</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span>
<a name="line-110"></a>
<a name="line-111"></a><a name="text"></a><span class='hs-definition'>text</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-112"></a><span class='hs-definition'>text</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>void</span> <span class='hs-varop'>$</span> <span class='hs-varid'>textNode</span> <span class='hs-varop'>$</span> <span class='hs-varid'>def</span> <span class='hs-varop'>&amp;</span> <span class='hs-varid'>textNodeConfig_initialContents</span> <span class='hs-varop'>.~</span> <span class='hs-varid'>t</span>
<a name="line-113"></a>
<a name="line-114"></a><a name="dynText"></a><span class='hs-comment'>{-# INLINABLE dynText #-}</span>
<a name="line-115"></a><span class='hs-definition'>dynText</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-116"></a><span class='hs-definition'>dynText</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-117"></a>  <span class='hs-varid'>postBuild</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getPostBuild</span>
<a name="line-118"></a>  <span class='hs-varid'>void</span> <span class='hs-varop'>$</span> <span class='hs-varid'>textNode</span> <span class='hs-varop'>$</span> <span class='hs-layout'>(</span><span class='hs-varid'>def</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TextNodeConfig</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varop'>&amp;</span> <span class='hs-varid'>textNodeConfig_setContents</span> <span class='hs-varop'>.~</span> <span class='hs-varid'>leftmost</span>
<a name="line-119"></a>    <span class='hs-keyglyph'>[</span> <span class='hs-varid'>updated</span> <span class='hs-varid'>t</span>
<a name="line-120"></a>    <span class='hs-layout'>,</span> <span class='hs-varid'>tag</span> <span class='hs-layout'>(</span><span class='hs-varid'>current</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span> <span class='hs-varid'>postBuild</span>
<a name="line-121"></a>    <span class='hs-keyglyph'>]</span>
<a name="line-122"></a>  <span class='hs-varid'>notReadyUntil</span> <span class='hs-varid'>postBuild</span>
<a name="line-123"></a>
<a name="line-124"></a><a name="display"></a><span class='hs-definition'>display</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-125"></a><span class='hs-definition'>display</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dynText</span> <span class='hs-varop'>.</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-conid'>T</span><span class='hs-varop'>.</span><span class='hs-varid'>pack</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span><span class='hs-layout'>)</span>
<a name="line-126"></a>
<a name="line-127"></a><a name="button"></a><span class='hs-definition'>button</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span>
<a name="line-128"></a><span class='hs-definition'>button</span> <span class='hs-varid'>t</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-129"></a>  <span class='hs-layout'>(</span><span class='hs-varid'>e</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>element</span> <span class='hs-str'>"button"</span> <span class='hs-varid'>def</span> <span class='hs-varop'>$</span> <span class='hs-varid'>text</span> <span class='hs-varid'>t</span>
<a name="line-130"></a>  <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>domEvent</span> <span class='hs-conid'>Click</span> <span class='hs-varid'>e</span>
<a name="line-131"></a>
<a name="line-132"></a><a name="dyn"></a><span class='hs-comment'>--TODO: Should this be renamed to 'widgetView' for consistency with 'widgetHold'?</span>
<a name="line-133"></a><span class='hs-comment'>-- | Given a Dynamic of widget-creating actions, create a widget that is recreated whenever the Dynamic updates.</span>
<a name="line-134"></a><span class='hs-comment'>--   The returned Event of widget results occurs when the Dynamic does.</span>
<a name="line-135"></a><span class='hs-comment'>--   Note:  Often, the type 'a' is an Event, in which case the return value is an Event-of-Events that would typically be flattened (via 'switchPromptly').</span>
<a name="line-136"></a><span class='hs-definition'>dyn</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-137"></a><span class='hs-definition'>dyn</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>networkView</span>
<a name="line-138"></a>
<a name="line-139"></a><a name="dyn_"></a><span class='hs-comment'>-- | Like 'dyn' but discards result.</span>
<a name="line-140"></a><span class='hs-definition'>dyn_</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-141"></a><span class='hs-definition'>dyn_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>void</span> <span class='hs-varop'>.</span> <span class='hs-varid'>dyn</span>
<a name="line-142"></a>
<a name="line-143"></a><a name="widgetHold"></a><span class='hs-comment'>-- | Given an initial widget and an Event of widget-creating actions, create a widget that is recreated whenever the Event fires.</span>
<a name="line-144"></a><span class='hs-comment'>--   The returned Dynamic of widget results occurs when the Event does.</span>
<a name="line-145"></a><span class='hs-comment'>--   Note:  Often, the type 'a' is an Event, in which case the return value is a Dynamic-of-Events that would typically be flattened.</span>
<a name="line-146"></a><span class='hs-definition'>widgetHold</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>MonadHold</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-147"></a><span class='hs-definition'>widgetHold</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>networkHold</span>
<a name="line-148"></a>
<a name="line-149"></a><a name="widgetHold_"></a><span class='hs-comment'>-- | Like 'widgetHold' but discards result.</span>
<a name="line-150"></a><span class='hs-definition'>widgetHold_</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>MonadHold</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-151"></a><span class='hs-definition'>widgetHold_</span> <span class='hs-varid'>z</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>void</span> <span class='hs-varop'>.</span> <span class='hs-varid'>widgetHold</span> <span class='hs-varid'>z</span>
<a name="line-152"></a>
<a name="line-153"></a><a name="el"></a><span class='hs-comment'>-- | Create a DOM element</span>
<a name="line-154"></a><span class='hs-comment'>-- &gt; el "div" (text "Hello World")</span>
<a name="line-155"></a><span class='hs-comment'>-- &lt;div&gt;Hello World&lt;/div&gt;</span>
<a name="line-156"></a><span class='hs-comment'>{-# INLINABLE el #-}</span>
<a name="line-157"></a><span class='hs-definition'>el</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-158"></a><span class='hs-definition'>el</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>el'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>child</span>
<a name="line-159"></a>
<a name="line-160"></a><a name="elAttr"></a><span class='hs-comment'>-- | Create a DOM element with attributes</span>
<a name="line-161"></a><span class='hs-comment'>-- &gt; elAttr "a" ("href" =: "<a href="http://google.com">http://google.com</a>") (text "Google!")</span>
<a name="line-162"></a><span class='hs-comment'>-- &lt;a href="<a href="http://google.com">http://google.com</a>"&gt;Google!&lt;/a&gt;</span>
<a name="line-163"></a><span class='hs-comment'>{-# INLINABLE elAttr #-}</span>
<a name="line-164"></a><span class='hs-definition'>elAttr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-165"></a><span class='hs-definition'>elAttr</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>elAttr'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span>
<a name="line-166"></a>
<a name="line-167"></a><a name="elClass"></a><span class='hs-comment'>-- | Create a DOM element with classes</span>
<a name="line-168"></a><span class='hs-comment'>-- &gt; elClass "div" "row" (return ())</span>
<a name="line-169"></a><span class='hs-comment'>-- &lt;div class="row"&gt;&lt;/div&gt;</span>
<a name="line-170"></a><span class='hs-comment'>{-# INLINABLE elClass #-}</span>
<a name="line-171"></a><span class='hs-definition'>elClass</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-172"></a><span class='hs-definition'>elClass</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>c</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>elClass'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>c</span> <span class='hs-varid'>child</span>
<a name="line-173"></a>
<a name="line-174"></a><a name="elDynAttr"></a><span class='hs-comment'>-- | Create a DOM element with Dynamic Attributes</span>
<a name="line-175"></a><span class='hs-comment'>-- &gt; elClass "div" (constDyn ("class" =: "row")) (return ())</span>
<a name="line-176"></a><span class='hs-comment'>-- &lt;div class="row"&gt;&lt;/div&gt;</span>
<a name="line-177"></a><span class='hs-comment'>{-# INLINABLE elDynAttr #-}</span>
<a name="line-178"></a><span class='hs-definition'>elDynAttr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-179"></a><span class='hs-definition'>elDynAttr</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>elDynAttr'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span>
<a name="line-180"></a>
<a name="line-181"></a><a name="elDynClass"></a><span class='hs-comment'>-- | Create a DOM element with a Dynamic Class</span>
<a name="line-182"></a><span class='hs-comment'>-- &gt; elDynClass "div" (constDyn "row") (return ())</span>
<a name="line-183"></a><span class='hs-comment'>-- &lt;div class="row"&gt;&lt;/div&gt;</span>
<a name="line-184"></a><span class='hs-comment'>{-# INLINABLE elDynClass #-}</span>
<a name="line-185"></a><span class='hs-definition'>elDynClass</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-186"></a><span class='hs-definition'>elDynClass</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>c</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>elDynClass'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>c</span> <span class='hs-varid'>child</span>
<a name="line-187"></a>
<a name="line-188"></a><a name="el'"></a><span class='hs-comment'>-- | Create a DOM element and return the element</span>
<a name="line-189"></a><span class='hs-comment'>-- &gt; do (e, _) &lt;- el' "div" (text "Click")</span>
<a name="line-190"></a><span class='hs-comment'>-- &gt;    return $ domEvent Click e</span>
<a name="line-191"></a><span class='hs-comment'>{-# INLINABLE el' #-}</span>
<a name="line-192"></a><span class='hs-definition'>el'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-193"></a><span class='hs-definition'>el'</span> <span class='hs-varid'>elementTag</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>element</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>def</span>
<a name="line-194"></a>
<a name="line-195"></a><a name="elAttr'"></a><span class='hs-comment'>-- | Create a DOM element with attributes and return the element</span>
<a name="line-196"></a><span class='hs-comment'>{-# INLINABLE elAttr' #-}</span>
<a name="line-197"></a><span class='hs-definition'>elAttr'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-198"></a><span class='hs-definition'>elAttr'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>element</span> <span class='hs-varid'>elementTag</span> <span class='hs-varop'>$</span> <span class='hs-varid'>def</span>
<a name="line-199"></a>  <span class='hs-varop'>&amp;</span> <span class='hs-varid'>initialAttributes</span> <span class='hs-varop'>.~</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>mapKeys</span> <span class='hs-layout'>(</span><span class='hs-conid'>AttributeName</span> <span class='hs-conid'>Nothing</span><span class='hs-layout'>)</span> <span class='hs-varid'>attrs</span>
<a name="line-200"></a>
<a name="line-201"></a><a name="elClass'"></a><span class='hs-comment'>-- | Create a DOM element with a class and return the element</span>
<a name="line-202"></a><span class='hs-comment'>{-# INLINABLE elClass' #-}</span>
<a name="line-203"></a><span class='hs-definition'>elClass'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-204"></a><span class='hs-definition'>elClass'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elAttr'</span> <span class='hs-varid'>elementTag</span> <span class='hs-layout'>(</span><span class='hs-str'>"class"</span> <span class='hs-varop'>=:</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-205"></a>
<a name="line-206"></a><a name="elDynAttr'"></a><span class='hs-comment'>-- | Create a DOM element with Dynamic Attributes and return the element</span>
<a name="line-207"></a><span class='hs-comment'>{-# INLINABLE elDynAttr' #-}</span>
<a name="line-208"></a><span class='hs-definition'>elDynAttr'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-209"></a><span class='hs-definition'>elDynAttr'</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elDynAttrNS'</span> <span class='hs-conid'>Nothing</span>
<a name="line-210"></a>
<a name="line-211"></a><a name="elDynClass'"></a><span class='hs-comment'>-- | Create a DOM element with a Dynamic class and return the element</span>
<a name="line-212"></a><span class='hs-comment'>{-# INLINABLE elDynClass' #-}</span>
<a name="line-213"></a><span class='hs-definition'>elDynClass'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-214"></a><span class='hs-definition'>elDynClass'</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elDynAttr'</span> <span class='hs-varid'>elementTag</span> <span class='hs-layout'>(</span><span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-str'>"class"</span> <span class='hs-varop'>=:</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span>
<a name="line-215"></a>
<a name="line-216"></a><a name="elDynAttrNS'"></a><span class='hs-comment'>{-# INLINABLE elDynAttrNS' #-}</span>
<a name="line-217"></a><span class='hs-definition'>elDynAttrNS'</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-218"></a><span class='hs-definition'>elDynAttrNS'</span> <span class='hs-varid'>mns</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-219"></a>  <span class='hs-varid'>modifyAttrs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>dynamicAttributesToModifyAttributes</span> <span class='hs-varid'>attrs</span>
<a name="line-220"></a>  <span class='hs-keyword'>let</span> <span class='hs-varid'>cfg</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>def</span>
<a name="line-221"></a>        <span class='hs-varop'>&amp;</span> <span class='hs-varid'>elementConfig_namespace</span> <span class='hs-varop'>.~</span> <span class='hs-varid'>mns</span>
<a name="line-222"></a>        <span class='hs-varop'>&amp;</span> <span class='hs-varid'>modifyAttributes</span> <span class='hs-varop'>.~</span> <span class='hs-varid'>fmapCheap</span> <span class='hs-varid'>mapKeysToAttributeName</span> <span class='hs-varid'>modifyAttrs</span>
<a name="line-223"></a>  <span class='hs-varid'>result</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>element</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>cfg</span> <span class='hs-varid'>child</span>
<a name="line-224"></a>  <span class='hs-varid'>postBuild</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getPostBuild</span>
<a name="line-225"></a>  <span class='hs-varid'>notReadyUntil</span> <span class='hs-varid'>postBuild</span>
<a name="line-226"></a>  <span class='hs-varid'>return</span> <span class='hs-varid'>result</span>
<a name="line-227"></a>
<a name="line-228"></a><a name="elDynAttrNS"></a><span class='hs-comment'>{-# INLINABLE elDynAttrNS #-}</span>
<a name="line-229"></a><span class='hs-definition'>elDynAttrNS</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-230"></a><span class='hs-definition'>elDynAttrNS</span> <span class='hs-varid'>mns</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-varid'>snd</span> <span class='hs-varop'>$</span> <span class='hs-varid'>elDynAttrNS'</span> <span class='hs-varid'>mns</span> <span class='hs-varid'>elementTag</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>child</span>
<a name="line-231"></a>
<a name="line-232"></a><a name="dynamicAttributesToModifyAttributes"></a><span class='hs-definition'>dynamicAttributesToModifyAttributes</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-233"></a><span class='hs-definition'>dynamicAttributesToModifyAttributes</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dynamicAttributesToModifyAttributesWithInitial</span> <span class='hs-varid'>mempty</span>
<a name="line-234"></a>
<a name="line-235"></a><a name="dynamicAttributesToModifyAttributesWithInitial"></a><span class='hs-definition'>dynamicAttributesToModifyAttributesWithInitial</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-236"></a><span class='hs-definition'>dynamicAttributesToModifyAttributesWithInitial</span> <span class='hs-varid'>attrs0</span> <span class='hs-varid'>d</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-237"></a>  <span class='hs-varid'>postBuild</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>getPostBuild</span>
<a name="line-238"></a>  <span class='hs-keyword'>let</span> <span class='hs-varid'>modificationsNeeded</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flip</span> <span class='hs-varid'>push</span> <span class='hs-layout'>(</span><span class='hs-varid'>align</span> <span class='hs-varid'>postBuild</span> <span class='hs-varop'>$</span> <span class='hs-varid'>updated</span> <span class='hs-varid'>d</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-239"></a>        <span class='hs-varid'>p</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>of</span>
<a name="line-240"></a>          <span class='hs-conid'>This</span> <span class='hs-conid'>()</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-241"></a>            <span class='hs-varid'>new</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sample</span> <span class='hs-varop'>$</span> <span class='hs-varid'>current</span> <span class='hs-varid'>d</span>
<a name="line-242"></a>            <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>diffMap</span> <span class='hs-varid'>attrs0</span> <span class='hs-varid'>new</span>
<a name="line-243"></a>          <span class='hs-conid'>These</span> <span class='hs-conid'>()</span> <span class='hs-varid'>new</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>diffMap</span> <span class='hs-varid'>attrs0</span> <span class='hs-varid'>new</span>
<a name="line-244"></a>          <span class='hs-conid'>That</span> <span class='hs-varid'>new</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-245"></a>            <span class='hs-varid'>old</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>sample</span> <span class='hs-varop'>$</span> <span class='hs-varid'>current</span> <span class='hs-varid'>d</span>
<a name="line-246"></a>            <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>diffMap</span> <span class='hs-varid'>old</span> <span class='hs-varid'>new</span>
<a name="line-247"></a>        <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>if</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>null</span> <span class='hs-varid'>p</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>Nothing</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>p</span>
<a name="line-248"></a>  <span class='hs-varid'>return</span> <span class='hs-varid'>modificationsNeeded</span>
<a name="line-249"></a>
<a name="line-250"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-251"></a><span class='hs-comment'>-- Copied and pasted from Reflex.Widget.Class</span>
<a name="line-252"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-253"></a>
<a name="line-254"></a><span class='hs-comment'>{-
<a name="line-255"></a>schedulePostBuild x = performEvent_ . (x &lt;$) =&lt;&lt; getPostBuild
<a name="line-256"></a>
<a name="line-257"></a>elDynHtml' :: DomBuilder t m =&gt; Text -&gt; Dynamic t Text -&gt; m (El t)
<a name="line-258"></a>elDynHtml' elementTag html = do
<a name="line-259"></a>  e &lt;- buildEmptyElement elementTag (Map.empty :: Map Text Text)
<a name="line-260"></a>  schedulePostBuild $ setInnerHTML e . Just =&lt;&lt; sample (current html)
<a name="line-261"></a>  performEvent_ $ fmap (setInnerHTML e . Just) $ updated html
<a name="line-262"></a>  wrapElement defaultDomEventHandler e
<a name="line-263"></a>
<a name="line-264"></a>elDynHtmlAttr' :: DomBuilder t m =&gt; Text -&gt; Map Text Text -&gt; Dynamic t Text -&gt; m (El t)
<a name="line-265"></a>elDynHtmlAttr' elementTag attrs html = do
<a name="line-266"></a>  e &lt;- buildEmptyElement elementTag attrs
<a name="line-267"></a>  schedulePostBuild $ setInnerHTML e . Just =&lt;&lt; sample (current html)
<a name="line-268"></a>  performEvent_ $ fmap (setInnerHTML e . Just) $ updated html
<a name="line-269"></a>  wrapElement defaultDomEventHandler e
<a name="line-270"></a>-}</span>
<a name="line-271"></a>
<a name="line-272"></a><a name="Link"></a><span class='hs-keyword'>newtype</span> <span class='hs-conid'>Link</span> <span class='hs-varid'>t</span>
<a name="line-273"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Link</span> <span class='hs-layout'>{</span> <span class='hs-sel'>_link_clicked</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-conid'>()</span>
<a name="line-274"></a>         <span class='hs-layout'>}</span>
<a name="line-275"></a>
<a name="line-276"></a><a name="linkClass"></a><span class='hs-definition'>linkClass</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Link</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-277"></a><span class='hs-definition'>linkClass</span> <span class='hs-varid'>s</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-278"></a>  <span class='hs-layout'>(</span><span class='hs-varid'>l</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>elAttr'</span> <span class='hs-str'>"a"</span> <span class='hs-layout'>(</span><span class='hs-str'>"class"</span> <span class='hs-varop'>=:</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-varid'>text</span> <span class='hs-varid'>s</span>
<a name="line-279"></a>  <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Link</span> <span class='hs-varop'>$</span> <span class='hs-varid'>domEvent</span> <span class='hs-conid'>Click</span> <span class='hs-varid'>l</span>
<a name="line-280"></a>
<a name="line-281"></a><a name="link"></a><span class='hs-definition'>link</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Link</span> <span class='hs-varid'>t</span><span class='hs-layout'>)</span>
<a name="line-282"></a><span class='hs-definition'>link</span> <span class='hs-varid'>s</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>linkClass</span> <span class='hs-varid'>s</span> <span class='hs-str'>""</span>
<a name="line-283"></a>
<a name="line-284"></a><a name="divClass"></a><span class='hs-definition'>divClass</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-285"></a><span class='hs-definition'>divClass</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elClass</span> <span class='hs-str'>"div"</span>
<a name="line-286"></a>
<a name="line-287"></a><a name="dtdd"></a><span class='hs-definition'>dtdd</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span><span class='hs-varop'>.</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>a</span>
<a name="line-288"></a><span class='hs-definition'>dtdd</span> <span class='hs-varid'>h</span> <span class='hs-varid'>w</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-289"></a>  <span class='hs-varid'>el</span> <span class='hs-str'>"dt"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>text</span> <span class='hs-varid'>h</span>
<a name="line-290"></a>  <span class='hs-varid'>el</span> <span class='hs-str'>"dd"</span> <span class='hs-varid'>w</span>
<a name="line-291"></a>
<a name="line-292"></a><a name="blank"></a><span class='hs-definition'>blank</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>m</span><span class='hs-varop'>.</span> <span class='hs-conid'>Monad</span> <span class='hs-varid'>m</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-293"></a><span class='hs-definition'>blank</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span> <span class='hs-conid'>()</span>
<a name="line-294"></a>
<a name="line-295"></a><a name="tableDynAttr"></a><span class='hs-comment'>-- | A widget to display a table with static columns and dynamic rows.</span>
<a name="line-296"></a><span class='hs-definition'>tableDynAttr</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>r</span> <span class='hs-varid'>k</span> <span class='hs-varid'>v</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>,</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>MonadHold</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>MonadFix</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span>
<a name="line-297"></a>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span>                                   <span class='hs-comment'>-- ^ Class applied to &lt;table&gt; element</span>
<a name="line-298"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-conid'>Text</span><span class='hs-layout'>,</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>      <span class='hs-comment'>-- ^ Columns of (header, row key -&gt; row value -&gt; child widget)</span>
<a name="line-299"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>                      <span class='hs-comment'>-- ^ Map from row key to row value</span>
<a name="line-300"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-conid'>Text</span> <span class='hs-conid'>Text</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- ^ Function to compute &lt;tr&gt; element attributes from row key</span>
<a name="line-301"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Element</span> <span class='hs-conid'>EventResult</span> <span class='hs-layout'>(</span><span class='hs-conid'>DomBuilderSpace</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>t</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>v</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>        <span class='hs-comment'>-- ^ Map from row key to (El, list of widget return values)</span>
<a name="line-302"></a><span class='hs-definition'>tableDynAttr</span> <span class='hs-varid'>klass</span> <span class='hs-varid'>cols</span> <span class='hs-varid'>dRows</span> <span class='hs-varid'>rowAttrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elAttr</span> <span class='hs-str'>"div"</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-str'>"style"</span> <span class='hs-str'>"zoom: 1; overflow: auto; background: white;"</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<a name="line-303"></a>    <span class='hs-varid'>elAttr</span> <span class='hs-str'>"table"</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-str'>"class"</span> <span class='hs-varid'>klass</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-304"></a>      <span class='hs-varid'>el</span> <span class='hs-str'>"thead"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>el</span> <span class='hs-str'>"tr"</span> <span class='hs-varop'>$</span>
<a name="line-305"></a>        <span class='hs-varid'>mapM_</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-layout'>(</span><span class='hs-varid'>h</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>el</span> <span class='hs-str'>"th"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>text</span> <span class='hs-varid'>h</span><span class='hs-layout'>)</span> <span class='hs-varid'>cols</span>
<a name="line-306"></a>      <span class='hs-varid'>el</span> <span class='hs-str'>"tbody"</span> <span class='hs-varop'>$</span>
<a name="line-307"></a>        <span class='hs-varid'>listWithKey</span> <span class='hs-varid'>dRows</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>k</span> <span class='hs-varid'>r</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-308"></a>          <span class='hs-varid'>dAttrs</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>rowAttrs</span> <span class='hs-varid'>k</span>
<a name="line-309"></a>          <span class='hs-varid'>elDynAttr'</span> <span class='hs-str'>"tr"</span> <span class='hs-varid'>dAttrs</span> <span class='hs-varop'>$</span> <span class='hs-varid'>mapM</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>el</span> <span class='hs-str'>"td"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>snd</span> <span class='hs-varid'>x</span> <span class='hs-varid'>k</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varid'>cols</span><span class='hs-layout'>)</span>
<a name="line-310"></a>
<a name="line-311"></a><a name="tabDisplay"></a><span class='hs-comment'>-- | A widget to construct a tabbed view that shows only one of its child widgets at a time.</span>
<a name="line-312"></a><span class='hs-comment'>--   Creates a header bar containing a &lt;ul&gt; with one &lt;li&gt; per child; clicking a &lt;li&gt; displays</span>
<a name="line-313"></a><span class='hs-comment'>--   the corresponding child and hides all others.</span>
<a name="line-314"></a><span class='hs-definition'>tabDisplay</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>forall</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span> <span class='hs-varid'>k</span><span class='hs-varop'>.</span> <span class='hs-layout'>(</span><span class='hs-conid'>MonadFix</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>DomBuilder</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>MonadHold</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>PostBuild</span> <span class='hs-varid'>t</span> <span class='hs-varid'>m</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span>
<a name="line-315"></a>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Text</span>               <span class='hs-comment'>-- ^ Class applied to &lt;ul&gt; element</span>
<a name="line-316"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Text</span>               <span class='hs-comment'>-- ^ Class applied to currently active &lt;li&gt; element</span>
<a name="line-317"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Map</span> <span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-conid'>Text</span><span class='hs-layout'>,</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span><span class='hs-layout'>)</span> <span class='hs-comment'>-- ^ Map from (arbitrary) key to (tab label, child widget)</span>
<a name="line-318"></a>  <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-conid'>()</span>
<a name="line-319"></a><span class='hs-definition'>tabDisplay</span> <span class='hs-varid'>ulClass</span> <span class='hs-varid'>activeClass</span> <span class='hs-varid'>tabItems</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-320"></a>  <span class='hs-keyword'>let</span> <span class='hs-varid'>t0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>listToMaybe</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>keys</span> <span class='hs-varid'>tabItems</span>
<a name="line-321"></a>  <span class='hs-varid'>rec</span> <span class='hs-varid'>currentTab</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Demux</span> <span class='hs-varid'>t</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>elAttr</span> <span class='hs-str'>"ul"</span> <span class='hs-layout'>(</span><span class='hs-str'>"class"</span> <span class='hs-varop'>=:</span> <span class='hs-varid'>ulClass</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-322"></a>        <span class='hs-varid'>tabClicksList</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-varid'>k</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>elems</span> <span class='hs-varop'>&lt;$&gt;</span> <span class='hs-varid'>imapM</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-varid'>s</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>headerBarLink</span> <span class='hs-varid'>s</span> <span class='hs-varid'>k</span> <span class='hs-varop'>$</span> <span class='hs-varid'>demuxed</span> <span class='hs-varid'>currentTab</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>tabItems</span>
<a name="line-323"></a>        <span class='hs-keyword'>let</span> <span class='hs-varid'>eTabClicks</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>leftmost</span> <span class='hs-varid'>tabClicksList</span>
<a name="line-324"></a>        <span class='hs-varid'>fmap</span> <span class='hs-varid'>demux</span> <span class='hs-varop'>$</span> <span class='hs-varid'>holdDyn</span> <span class='hs-varid'>t0</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fmap</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>eTabClicks</span>
<a name="line-325"></a>  <span class='hs-varid'>el</span> <span class='hs-str'>"div"</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-326"></a>    <span class='hs-varid'>iforM_</span> <span class='hs-varid'>tabItems</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>k</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<a name="line-327"></a>      <span class='hs-keyword'>let</span> <span class='hs-varid'>isSelected</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>demuxed</span> <span class='hs-varid'>currentTab</span> <span class='hs-varop'>$</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>k</span>
<a name="line-328"></a>          <span class='hs-varid'>attrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ffor</span> <span class='hs-varid'>isSelected</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><span class='hs-varid'>s</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>s</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-str'>"style"</span> <span class='hs-str'>"display:none;"</span>
<a name="line-329"></a>      <span class='hs-varid'>elDynAttr</span> <span class='hs-str'>"div"</span> <span class='hs-varid'>attrs</span> <span class='hs-varid'>w</span>
<a name="line-330"></a>    <span class='hs-varid'>return</span> <span class='hs-conid'>()</span>
<a name="line-331"></a>  <span class='hs-keyword'>where</span>
<a name="line-332"></a>    <span class='hs-varid'>headerBarLink</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Text</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>k</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Dynamic</span> <span class='hs-varid'>t</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span> <span class='hs-layout'>(</span><span class='hs-conid'>Event</span> <span class='hs-varid'>t</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span>
<a name="line-333"></a>    <span class='hs-varid'>headerBarLink</span> <span class='hs-varid'>x</span> <span class='hs-varid'>k</span> <span class='hs-varid'>isSelected</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<a name="line-334"></a>      <span class='hs-keyword'>let</span> <span class='hs-varid'>attrs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>\</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>if</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-str'>"class"</span> <span class='hs-varid'>activeClass</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span><span class='hs-layout'>)</span> <span class='hs-varid'>isSelected</span>
<a name="line-335"></a>      <span class='hs-varid'>elDynAttr</span> <span class='hs-str'>"li"</span> <span class='hs-varid'>attrs</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<a name="line-336"></a>        <span class='hs-varid'>a</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>link</span> <span class='hs-varid'>x</span>
<a name="line-337"></a>        <span class='hs-varid'>return</span> <span class='hs-varop'>$</span> <span class='hs-varid'>fmap</span> <span class='hs-layout'>(</span><span class='hs-varid'>const</span> <span class='hs-varid'>k</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-sel'>_link_clicked</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-338"></a>
<a name="line-339"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HasAttributes</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>where</span>
<a name="line-340"></a>  <span class='hs-keyword'>type</span> <span class='hs-conid'>Attrs</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-varop'>*</span>
<a name="line-341"></a>  <span class='hs-varid'>attributes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Lens'</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Attrs</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
</pre></body>
</html>
